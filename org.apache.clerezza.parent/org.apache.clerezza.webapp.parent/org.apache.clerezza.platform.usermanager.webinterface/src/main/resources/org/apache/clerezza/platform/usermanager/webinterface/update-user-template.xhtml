<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" id="tx-html">
	<head>
    	<title>User Management</title>
		${ns:umr=http://clerezza.org/2009/05/usermanager#}
		${ns:foaf=http://xmlns.com/foaf/0.1/}
		${ns:dc=http://purl.org/dc/elements/1.1/}
		${ns:osgi=http://clerezza.org/2008/11/osgi#}
		${ns:permission=http://clerezza.org/2008/10/permission#}
		${ns:sioc=http://rdfs.org/sioc/ns#}
		${ns:dc=http://purl.org/dc/elements/1.1/}
		${ns:dhb=http://clerezza.org/2009/06/dashboard#}
		
		<link href="/style/style.css" media="screen" rel="stylesheet" type="text/css" />
        <script src="/jquery/jquery-1.3.2.min.js" type="text/javascript"></script>
        <script src="/jquery/jquery.menu.js" type="text/javascript"></script>
        <script src="./js/usermanager.js" type="text/javascript"></script>
        <script type="text/javascript">
			$(document).ready(function() {
				refreshCustomInformation('${if umr:user/foaf:name}${umr:user/foaf:name}${/if}');
				
				 $("#userRoles option").each(function() {
				 	$(this).bind("click", function() {
						refreshCustomInformation('${if umr:user/foaf:name}${umr:user/foaf:name}${/if}');
					});
				 });
			});
			var userRoles = new Array();
			${loop}${loop}
				userRoles.push('${umr:user/sioc:has_function/dc:title}');
			${/loop}${/loop}
	
			$(document).ready(function () {
				$('#userRoles').val(userRoles);
			});
	
			var multiplefield = new Array();

		</script>
	</head>
	<body id="tx-body">
        <div id="tx-header">

			<div id="tx-system">
				${render(dhb:includeDashBoardMenu, "naked")}
			</div>
			<div id="tx-module">
				<h1>User Manager</h1>
			</div>
		
		
			<div id="tx-module-tabs" class="clearfix">
				<ol id="tx-tabs">
					<li class="tx-active"><a href="#">Users</a></li>
					<li><a href="list-roles">Roles</a></li>
				</ol>

				<div id="tx-contextual-buttons">
					<ol>
						<li><a href="list-users" class="tx-button tx-button-remove">Cancel</a></li>
						<li><a href="javascript:saveUser()" class="tx-button tx-button-create">Save</a></li>
					</ol>
				</div>

			</div >
		</div>
        <div id="tx-content">
            <div class="tx-panel" id="tx-panel">
            </div>    
            
            <div id="list">
                <form id="userform" name="userform" action="update-user" method="post" style="width:600px; float:left; margin-right:50px; text-align:right" enctype="multipart/form-data">
                <div style="float:left; width:300px;">
                    <fieldset border="1px">	
                        <legend>Basic User Information</legend>
                        <label>Username: <input name="userName" type="text" value="${if umr:user/foaf:name}${umr:user/foaf:name}${/if}"/></label><br />	
                        <label>Email: <input name="email" type="text" value="${if umr:user/foaf:mbox}${umr:user/foaf:mbox}${/if}"/></label><br />
                        <label>Path Prefix: <input name="pathPrefix" type="text" value="${if umr:user/osgi:agent_path_prefix}${umr:user/osgi:agent_path_prefix}${/if}"/></label><br />
                        <label>User Roles: 
                            <select name="userRoles" id="userRoles" size="3" multiple="multiple">
                                ${loop}
                                    <option value="${umr:role/dc:title}">${umr:role/dc:title}</option>
                                ${/loop}
                            </select>
                        </label><br /><br />
                        <div>Custom information can be added via role manager <a href="list-roles">list roles</a> </div>
                        <br />
                    </fieldset> 
                </div>
                <div id="custominfos" style="float:right;  width:250px;"></div>
                </form>
            </div>
        </div>
	</body>
</html>