def foaf(s: Any) = new UriRef("http://xmlns.com/foaf/0.1/" + s)
def osgi(s: Any) = new UriRef("http://clerezza.org/2008/11/osgi#" + s)
def permission(s: Any) = new UriRef("http://clerezza.org/2008/10/permission#" + s)
def list(s: Any) = new UriRef("http://clerezza.org/2009/04/list#" + s)
def sioc(s: Any) = new UriRef("http://rdfs.org/sioc/ns#" + s)
def dc(s: Any) = new UriRef("http://purl.org/dc/elements/1.1/" + s)
def platform(s: Any) = new UriRef("http://clerezza.org/2009/08/platform#" + s)

resultDocModifier.addStyleSheet("js/fancybox/jquery.fancybox.css");
resultDocModifier.addScriptReference("js/fancybox/jquery.fancybox-1.2.1.pack.js");
resultDocModifier.addScriptReference("js/usermanager-overview.js");

resultDocModifier.setTitle("User Manager");
resultDocModifier.addNodes2Elem("tx-module", <h1>User Manager</h1>);

resultDocModifier.addNodes2Elem("tx-module-tabs-ol", <li class="tx-active"><a href="#">Users</a></li>);
resultDocModifier.addNodes2Elem("tx-module-tabs-ol", <li><a href="list-roles">Roles</a></li>);

resultDocModifier.addNodes2Elem("tx-contextual-buttons-ol", <li><a id="deleteButton" class="tx-button tx-button-remove" href="#">Remove</a></li>);
resultDocModifier.addNodes2Elem("tx-contextual-buttons-ol", <li><a id="editButton" class="tx-button tx-button-modify" href="#">Edit</a></li>);
resultDocModifier.addNodes2Elem("tx-contextual-buttons-ol", <li><a id="addButton" class="tx-button tx-button-create" href="add-user">Create</a></li>);

<div id="tx-content">
	<div class="tx-list">
		<fieldset>
			<table>
				<colgroup>
					<col width="40" />
					<col width="40" />
					<col width="40" />
					<col width="120" />
					<col width="150" />
					<col width="100" />
					<col width="100" />
				</colgroup>
				<thead>
					<tr>
						<th colspan="2"><a href="">Name</a></th>
						<th><a href="">Email</a></th>
						<th><a href="">Path Prefix</a></th>
						<th><a href="">Password</a></th>
						<th><a href="">Roles</a></th>
						<th><a href="">Permissions</a></th>
					</tr>
				</thead>
				<tbody>
                    {for (user <- (res!!)) yield {
					<tr id={user/platform("userName")*}>
                        <td>
                            <input type="checkbox" value={user/platform("userName")*} />
                        </td>
                        <td><a href={"update-user?userName=" + (user/platform("userName")*)}>{user/platform("userName")*}</a></td>
                        <td>{user/foaf("mbox")*}</td>
                        <td>{user/osgi("agent_path_prefix")*}</td>
                        <td>{user/permission("passwordSha1")*}</td>
                        <td>{for (title <- (user/sioc("has_function"))) yield {  title/dc("title")* }}</td>
                        <td><a href={"manage-user-permissions?userName=" + (user/platform("userName")*)}>show permissions</a></td>
                    </tr>
                    }}
				</tbody>
			</table>
		</fieldset>
	</div>
	{if (!((res/list("indexFrom")*).equals(""))) {
		if (!((res/list("indexFrom")*).equals("0"))) {
			<a href={res/list("predecessor")*}>Prev Page</a>
		} else {
			<div></div>
		}
		} else { <div></div> }
	if (!((res/list("indexTo")*).equals((res/list("length")*)))) {
		<a href="${list:successor}">Next Page</a>
	} else {
		<div></div>
	}}
</div>